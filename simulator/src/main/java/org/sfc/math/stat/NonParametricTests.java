/*
 * Copyright (c) 2008 Thomas Weise for sigoa
 * Simple Interface for Global Optimization Algorithms
 * http://www.sigoa.org/
 * 
 * E-Mail           : info@sigoa.org
 * Creation Date    : 2008-08-17
 * Creator          : Thomas Weise
 * Original Filename: org.sfc.math.stat.SignTest.java
 * Last modification: 2008-08-17
 *                by: Thomas Weise
 * 
 * License          : GNU LESSER GENERAL PUBLIC LICENSE
 *                    Version 2.1, February 1999
 *                    You should have received a copy of this license along
 *                    with this library; if not, write to theFree Software
 *                    Foundation, Inc. 51 Franklin Street, Fifth Floor,
 *                    Boston, MA 02110-1301, USA or download the license
 *                    under http://www.gnu.org/licenses/lgpl.html or
 *                    http://www.gnu.org/copyleft/lesser.html.
 *                    
 * Warranty         : This software is provided "as is" without any
 *                    warranty; without even the implied warranty of
 *                    merchantability or fitness for a particular purpose.
 *                    See the Gnu Lesser General Public License for more
 *                    details.
 */

package org.sfc.math.stat;

import org.sfc.math.Mathematics;

/**
 * The sign test
 * 
 * @author Thomas Weise
 */
public class NonParametricTests {

  /**
   * the signed rank two-sided probabilities
   */
  private static final double[] SIGNED_RANK_PROB = new double[] { 0.2d,
      0.1d, 0.05d, 0.02d, 0.01d, 0.005d, 0.002d };

  /**
   * the table for the signed rank values
   */
  private static final double[][] SIGNED_RANK = new double[][] {
      { -1d, -1d, -1d, -1d, -1d, -1d, -1d },//
      { -1d, -1d, -1d, -1d, -1d, -1d, -1d },//
      { -1d, -1d, -1d, -1d, -1d, -1d, -1d },//
      { -1d, -1d, -1d, -1d, -1d, -1d, -1d },//
      { 0, -1d, -1d, -1d, -1d, -1d, -1d },//
      { 2, 0, -1d, -1d, -1d, -1d, -1d },//
      { 3, 2, 0, -1d, -1d, -1d, -1d },//
      { 5, 3, 2, 0, -1d, -1d, -1d },//
      { 8, 5, 3, 1, 0, -1d, -1d },//
      { 8, 5, 3, 1, 0, -1d, -1d },//
      { 14, 10, 8, 5, 3, 1, 0 },//
      { 17, 13, 10, 7, 5, 3, 1 },//
      { 21, 17, 13, 9, 7, 5, 2 },//
      { 26, 21, 17, 12, 9, 7, 4 },//
      { 31, 25, 21, 15, 12, 9, 6 },//
      { 36, 30, 25, 19, 15, 12, 8 },//
      { 42, 35, 29, 23, 19, 15, 11 },//
      { 48, 41, 34, 27, 23, 19, 14 },//
      { 55, 47, 40, 32, 27, 23, 18 },//
      { 62, 53, 46, 37, 32, 27, 21 },//
      { 69, 60, 52, 43, 37, 32, 26 },//
      { 77, 67, 58, 49, 42, 37, 30 },//
      { 86, 75, 65, 55, 48, 42, 35 },//
      { 94, 83, 73, 62, 54, 48, 40 },//
      { 104, 91, 81, 69, 61, 54, 45 },//
      { 113, 100, 89, 76, 68, 60, 51 },//
      { 124, 110, 98, 84, 75, 67, 58 },//
      { 134, 119, 107, 92, 83, 74, 64 },//
      { 145, 130, 116, 101, 91, 82, 71 },//
      { 157, 140, 126, 110, 100, 90, 79 },//
      { 169, 151, 137, 120, 109, 98, 86 },//
      { 181, 163, 147, 130, 118, 107, 94 },//
      { 194, 175, 159, 140, 128, 116, 103 },//
      { 207, 187, 170, 151, 138, 126, 112 },//
      { 221, 200, 182, 162, 148, 136, 121 },//
      { 235, 213, 195, 173, 159, 146, 131 },//
      { 250, 227, 208, 185, 171, 157, 141 },//
      { 265, 241, 221, 198, 182, 168, 151 },//
      { 281, 256, 235, 211, 194, 180, 162 },//
      { 297, 271, 249, 224, 207, 192, 173 },//
      { 313, 286, 264, 238, 220, 204, 185 },//
      { 330, 302, 279, 252, 233, 217, 197 },//
      { 348, 319, 294, 266, 247, 230, 209 },//
      { 365, 336, 310, 281, 261, 244, 222 },//
      { 384, 353, 327, 296, 276, 258, 235 },//
      { 402, 371, 343, 312, 291, 272, 249 },//
      { 422, 389, 361, 328, 307, 287, 263 },//
      { 441, 407, 378, 345, 322, 302, 277 },//
      { 462, 426, 396, 362, 339, 318, 292 },//
      { 482, 446, 415, 379, 355, 334, 307 },//
      { 503, 466, 434, 397, 373, 350, 323 },//
      { 525, 486, 453, 416, 390, 367, 339 },//
      { 547, 507, 473, 434, 408, 384, 355 },//
      { 569, 529, 494, 454, 427, 402, 372 },//
      { 592, 550, 514, 473, 445, 420, 389 },//
      { 615, 573, 536, 493, 465, 439, 407 },//
      { 639, 595, 557, 514, 484, 457, 425 },//
      { 664, 618, 579, 535, 504, 477, 443 },//
      { 688, 642, 602, 556, 525, 497, 462 },//
      { 714, 666, 625, 578, 546, 517, 482 },//
      { 739, 690, 648, 600, 567, 537, 501 },//
      { 765, 715, 672, 623, 589, 558, 521 },//
      { 792, 741, 697, 646, 611, 580, 542 },//
      { 819, 767, 721, 669, 634, 602, 563 },//
      { 847, 793, 747, 693, 657, 624, 584 },//
      { 875, 820, 772, 718, 681, 647, 606 },//
      { 903, 847, 798, 742, 705, 670, 628 },//
      { 932, 875, 825, 768, 729, 694, 651 },//
      { 962, 903, 852, 793, 754, 718, 674 },//
      { 992, 931, 879, 819, 779, 742, 697 },//
      { 1022, 960, 907, 846, 805, 767, 721 },//
      { 1053, 990, 936, 873, 831, 792, 745 },//
      { 1084, 1020, 964, 901, 858, 818, 770 },//
      { 1116, 1050, 994, 928, 884, 844, 795 },//
      { 1148, 1081, 1023, 957, 912, 871, 821 },//
      { 1181, 1112, 1053, 986, 940, 898, 847 },//
      { 1214, 1144, 1084, 1015, 968, 925, 873 },//
      { 1247, 1176, 1115, 1044, 997, 953, 900 },//
      { 1282, 1209, 1147, 1075, 1026, 981, 927 },//
      { 1316, 1242, 1179, 1105, 1056, 1010, 955 },//
      { 1351, 1276, 1211, 1136, 1086, 1039, 983 },//
      { 1387, 1310, 1244, 1168, 1116, 1069, 1011 },//
      { 1423, 1345, 1277, 1200, 1147, 1099, 1040 },//
      { 1459, 1380, 1311, 1232, 1178, 1129, 1070 },//
      { 1496, 1415, 1345, 1265, 1210, 1160, 1099 },//
      { 1533, 1451, 1380, 1298, 1242, 1191, 1130 },//
      { 1571, 1487, 1415, 1332, 1275, 1223, 1160 },//
      { 1609, 1524, 1451, 1366, 1308, 1255, 1191 },//
      { 1648, 1561, 1487, 1400, 1342, 1288, 1223 },//
      { 1688, 1599, 1523, 1435, 1376, 1321, 1255 },//
      { 1727, 1638, 1560, 1471, 1410, 1355, 1287 },//
      { 1767, 1676, 1597, 1507, 1445, 1389, 1320 },//
      { 1808, 1715, 1635, 1543, 1480, 1423, 1353 },//
      { 1849, 1755, 1674, 1580, 1516, 1458, 1387 },//
      { 1891, 1795, 1712, 1617, 1552, 1493, 1421 },//
      { 1933, 1836, 1752, 1655, 1589, 1529, 1455 },//
      { 1976, 1877, 1791, 1693, 1626, 1565, 1490 },//
      { 2019, 1918, 1832, 1731, 1664, 1601, 1525 },//
      { 2062, 1960, 1872, 1770, 1702, 1638, 1561 },//
      { 2106, 2003, 1913, 1810, 1740, 1676, 1598 },//
      { 2151, 2045, 1955, 1850, 1779, 1714, 1634 },//
      { 2195, 2089, 1997, 1890, 1818, 1752, 1671 },//
      { 2241, 2133, 2039, 1931, 1858, 1791, 1709 },//
      { 2287, 2177, 2082, 1972, 1898, 1830, 1747 },//
      { 2333, 2222, 2125, 2014, 1939, 1870, 1785 },//
      { 2380, 2267, 2169, 2056, 1980, 1910, 1824 },//
      { 2427, 2312, 2213, 2099, 2022, 1950, 1863 },//
      { 2475, 2359, 2258, 2142, 2063, 1991, 1903 },//
      { 2523, 2405, 2303, 2186, 2106, 2032, 1943 },//
      { 2572, 2452, 2349, 2230, 2149, 2074, 1984 },//
      { 2621, 2500, 2395, 2274, 2192, 2117, 2025 },//
      { 2671, 2548, 2442, 2319, 2236, 2159, 2066 },//
      { 2721, 2596, 2489, 2364, 2280, 2202, 2108 },//
      { 2771, 2645, 2536, 2410, 2325, 2246, 2150 },//
      { 2822, 2695, 2584, 2456, 2370, 2290, 2193 },//
      { 2874, 2744, 2632, 2503, 2415, 2335, 2236 },//
      { 2926, 2795, 2681, 2550, 2461, 2380, 2280 },//
      { 2978, 2846, 2731, 2598, 2508, 2425, 2324 },//
      { 3031, 2897, 2780, 2646, 2555, 2471, 2368 },//
      { 3085, 2948, 2831, 2694, 2602, 2517, 2413 },//
      { 3139, 3001, 2881, 2743, 2650, 2564, 2459 },//
      { 3193, 3053, 2933, 2793, 2698, 2611, 2505 },//
      { 3248, 3106, 2984, 2843, 2747, 2658, 2551 },//
      { 3303, 3160, 3036, 2893, 2796, 2707, 2598 },//
      { 3359, 3214, 3089, 2944, 2846, 2755, 2645 },//
      { 3416, 3269, 3142, 2995, 2896, 2804, 2692 },//
      { 3472, 3324, 3195, 3047, 2946, 2853, 2740 },//
      { 3530, 3379, 3249, 3099, 2997, 2903, 2789 },//
      { 3587, 3435, 3304, 3152, 3049, 2953, 2838 },//
      { 3645, 3492, 3359, 3205, 3100, 3004, 2887 },//
      { 3704, 3548, 3414, 3258, 3153, 3055, 2937 },//
      { 3763, 3606, 3470, 3312, 3205, 3107, 2987 },//
      { 3823, 3664, 3526, 3367, 3259, 3159, 3038 },//
      { 3883, 3722, 3583, 3421, 3312, 3212, 3089 },//
      { 3944, 3781, 3640, 3477, 3366, 3264, 3140 },//
      { 4005, 3840, 3697, 3533, 3421, 3318, 3192 },//
      { 4066, 3900, 3756, 3589, 3476, 3372, 3245 },//
      { 4128, 3960, 3814, 3646, 3531, 3426, 3298 },//
      { 4191, 4020, 3873, 3703, 3587, 3481, 3351 },//
      { 4254, 4081, 3933, 3760, 3644, 3536, 3405 },//
      { 4317, 4143, 3993, 3819, 3701, 3592, 3459 },//
      { 4381, 4205, 4053, 3877, 3758, 3648, 3514 },//
      { 4445, 4268, 4114, 3936, 3816, 3704, 3569 },//
      { 4510, 4331, 4175, 3996, 3874, 3761, 3624 },//
      { 4575, 4394, 4237, 4055, 3932, 3819, 3680 },//
      { 4641, 4458, 4299, 4116, 3991, 3877, 3737 },//
      { 4708, 4522, 4362, 4177, 4051, 3935, 3793 },//
      { 4774, 4587, 4425, 4238, 4111, 3994, 3851 },//
      { 4842, 4652, 4489, 4300, 4171, 4053, 3908 },//
      { 4909, 4718, 4553, 4362, 4232, 4113, 3967 },//
      { 4978, 4785, 4618, 4425, 4294, 4173, 4025 },//
      { 5046, 4851, 4683, 4488, 4355, 4233, 4084 },//
      { 5115, 4919, 4748, 4551, 4418, 4294, 4144 },//
      { 5185, 4986, 4814, 4615, 4480, 4356, 4204 },//
      { 5255, 5054, 4881, 4680, 4544, 4418, 4264 },//
      { 5326, 5123, 4948, 4745, 4607, 4480, 4325 },//
      { 5397, 5192, 5015, 4810, 4671, 4543, 4387 },//
      { 5468, 5262, 5083, 4876, 4736, 4606, 4448 },//
      { 5540, 5332, 5151, 4943, 4801, 4670, 4511 },//
      { 5613, 5402, 5220, 5009, 4866, 4734, 4573 },//
      { 5686, 5473, 5289, 5077, 4932, 4799, 4636 },//
      { 5759, 5545, 5359, 5144, 4999, 4864, 4700 },//
      { 5833, 5617, 5429, 5213, 5065, 4930, 4764 },//
      { 5908, 5689, 5500, 5281, 5133, 4996, 4828 },//
      { 5982, 5762, 5571, 5350, 5200, 5062, 4893 },//
      { 6058, 5835, 5643, 5420, 5269, 5129, 4959 },//
      { 6134, 5909, 5715, 5490, 5337, 5196, 5024 },//
      { 6210, 5983, 5787, 5560, 5406, 5264, 5091 },//
      { 6287, 6058, 5860, 5631, 5476, 5332, 5157 },//
      { 6364, 6133, 5934, 5703, 5546, 5401, 5224 },//
      { 6442, 6209, 6008, 5775, 5616, 5470, 5292 },//
      { 6520, 6285, 6082, 5847, 5687, 5540, 5360 },//
      { 6599, 6362, 6157, 5920, 5759, 5610, 5429 },//
      { 6678, 6439, 6232, 5993, 5831, 5681, 5497 },//
      { 6758, 6517, 6308, 6067, 5903, 5752, 5567 },//
      { 6838, 6595, 6385, 6141, 5976, 5823, 5637 },//
      { 6919, 6673, 6461, 6216, 6049, 5895, 5707 },//
      { 7000, 6752, 6538, 6291, 6123, 5967, 5778 },//
      { 7081, 6832, 6616, 6366, 6197, 6040, 5849 },//
      { 7163, 6912, 6694, 6442, 6271, 6113, 5921 },//
      { 7246, 6992, 6773, 6519, 6346, 6187, 5993 },//
      { 7329, 7073, 6852, 6596, 6422, 6261, 6065 },//
      { 7412, 7155, 6932, 6673, 6498, 6336, 6138 },//
      { 7496, 7236, 7012, 6751, 6574, 6411, 6212 },//
      { 7581, 7319, 7092, 6829, 6651, 6486, 6285 },//
      { 7666, 7402, 7173, 6908, 6728, 6562, 6360 },//
      { 7751, 7485, 7254, 6987, 6806, 6639, 6435 },//
      { 7837, 7569, 7336, 7067, 6884, 6716, 6510 },//
      { 7924, 7653, 7419, 7147, 6963, 6793, 6585 },//
      { 8010, 7738, 7502, 7228, 7042, 6871, 6662 },//
      { 8098, 7823, 7585, 7309, 7122, 6949, 6738 },//
      { 8186, 7908, 7669, 7391, 7202, 7028, 6815 },//
      { 8274, 7995, 7753, 7473, 7283, 7107, 6893 },//
      { 8363, 8081, 7838, 7555, 7364, 7187, 6971 },//
      { 8452, 8168, 7923, 7638, 7445, 7267, 7049 },//
      { 8542, 8256, 8008, 7722, 7527, 7347, 7128 },//
      { 8632, 8344, 8095, 7806, 7610, 7428, 7207 },//
      { 8723, 8432, 8181, 7890, 7692, 7510, 7287 },//
      { 8814, 8521, 8268, 7975, 7776, 7592, 7367 },//
      { 8905, 8611, 8356, 8060, 7859, 7674, 7448 },//
      { 8998, 8701, 8444, 8146, 7944, 7757, 7529 } //
  };

  /**
   * the precise wilcoxon values
   */
  private static final double[][] PREC_WILCOXON = new double[][] {
      {},//
      {},//
      {},//
      {},//
      { 2d * 0.06250d },//
      { 2d * 0.03125d, 2d * 0.06250d, 2d * 0.09375d },//
      { 2d * 0.01563d, 2d * 0.03125d, 2d * 0.04688d, 2d * 0.07813d },//
      { 2d * 0.007813d, 2d * 0.01563d, 2d * 0.02344d, 2d * 0.03906d,
          2d * 0.05469d, 2d * 0.07813d },//
      { 2d * 0.003906d, 2d * 0.007813d, 2d * 0.01172d, 2d * 0.01953d,
          2d * 0.02734d, 2d * 0.03906d, 2d * 0.05469d, 2d * 0.07422d,
          2d * 0.09766d },//
      { 2d * 0.001953d, 2d * 0.003906d, 2d * 0.005859d, 2d * 0.009766d,
          2d * 0.01367d, 2d * 0.01953d, 2d * 0.02734d, 2d * 0.03711d,
          2d * 0.04883d, 2d * 0.06445d, 2d * 0.08203d },//
      { 2d * 0.0009766d, 2d * 0.001953d, 2d * 0.002930d, 2d * 0.004883d,
          2d * 0.006836d, 2d * 0.009766d, 2d * 0.01367d, 2d * 0.01855d,
          2d * 0.02441d, 2d * 0.03223d, 2d * 0.04199d, 2d * 0.05273d,
          2d * 0.06543d, 2d * 0.08008d, 2d * 0.09668d },//
      { 2d * 0.0004883d, 2d * 0.0009766d, 2d * 0.001465d, 2d * 0.002441d,
          2d * 0.003418d, 2d * 0.004883d, 2d * 0.006836d, 2d * 0.009277d,
          2d * 0.01221d, 2d * 0.01611d, 2d * 0.02100d, 2d * 0.02686d,
          2d * 0.03369d, 2d * 0.04150d, 2d * 0.05078d, 2d * 0.06152d,
          2d * 0.07373d, 2d * 0.08740d },//
      { 2d * 0.0002441d, 2d * 0.0004883d, 2d * 0.0007324d, 2d * 0.001221d,
          2d * 0.001709d, 2d * 0.002441d, 2d * 0.003418d, 2d * 0.004639d,
          2d * 0.006104d, 2d * 0.008057d, 2d * 0.01050d, 2d * 0.01343d,
          2d * 0.01709d, 2d * 0.02124d, 2d * 0.02612d, 2d * 0.03198d,
          2d * 0.03857d, 2d * 0.04614d, 2d * 0.05493d, 2d * 0.06470d,
          2d * 0.07568d, 2d * 0.08813d },//
      { 2d * 0.0001221d, 2d * 0.0002441d, 2d * 0.0003662d,
          2d * 0.0006104d, 2d * 0.0008545d, 2d * 0.001221d,
          2d * 0.001709d, 2d * 0.002319d, 2d * 0.003052d, 2d * 0.004028d,
          2d * 0.005249d, 2d * 0.006714d, 2d * 0.008545d, 2d * 0.01074d,
          2d * 0.01331d, 2d * 0.01636d, 2d * 0.01990d, 2d * 0.02393d,
          2d * 0.02869d, 2d * 0.03406d, 2d * 0.04016d, 2d * 0.04712d,
          2d * 0.05493d, 2d * 0.06360d, 2d * 0.07324d, 2d * 0.08386d,
          2d * 0.09546d },//
      { 2d * 6.104E-05d, 2d * 0.0001221d, 2d * 0.0001831d,
          2d * 0.0003052d, 2d * 0.0004272d, 2d * 0.0006104d,
          2d * 0.0008545d, 2d * 0.001160d, 2d * 0.001526d, 2d * 0.002014d,
          2d * 0.002625d, 2d * 0.003357d, 2d * 0.004272d, 2d * 0.005371d,
          2d * 0.006714d, 2d * 0.008301d, 2d * 0.01013d, 2d * 0.01227d,
          2d * 0.01477d, 2d * 0.01764d, 2d * 0.02094d, 2d * 0.02472d,
          2d * 0.02899d, 2d * 0.03381d, 2d * 0.03925d, 2d * 0.04529d,
          2d * 0.05200d, 2d * 0.05945d, 2d * 0.06763d, 2d * 0.07654d,
          2d * 0.08630d, 2d * 0.09686d },//
      { 2d * 3.052E-05d, 2d * 6.104E-05d, 2d * 9.155E-05d,
          2d * 0.0001526d, 2d * 0.0002136d, 2d * 0.0003052d,
          2d * 0.0004272d, 2d * 0.0005798d, 2d * 0.0007629d,
          2d * 0.001007d, 2d * 0.001312d, 2d * 0.001678d, 2d * 0.002136d,
          2d * 0.002686d, 2d * 0.003357d, 2d * 0.004181d, 2d * 0.005127d,
          2d * 0.006226d, 2d * 0.007538d, 2d * 0.009033d, 2d * 0.01077d,
          2d * 0.01279d, 2d * 0.01508d, 2d * 0.01767d, 2d * 0.02063d,
          2d * 0.02396d, 2d * 0.02768d, 2d * 0.03186d, 2d * 0.03650d,
          2d * 0.04163d, 2d * 0.04730d, 2d * 0.05350d, 2d * 0.06027d,
          2d * 0.06769d, 2d * 0.07571d, 2d * 0.08441d, 2d * 0.09381d },//
      { 2d * 1.526E-05d, 2d * 3.052E-05d, 2d * 4.578E-05d,
          2d * 7.629E-05d, 2d * 0.0001068d, 2d * 0.0001526d,
          2d * 0.0002136d, 2d * 0.0002899d, 2d * 0.0003815d,
          2d * 0.0005035d, 2d * 0.0006561d, 2d * 0.0008392d,
          2d * 0.001068d, 2d * 0.001343d, 2d * 0.001678d, 2d * 0.002090d,
          2d * 0.002579d, 2d * 0.003143d, 2d * 0.003815d, 2d * 0.004593d,
          2d * 0.005493d, 2d * 0.006546d, 2d * 0.007751d, 2d * 0.009125d,
          2d * 0.01070d, 2d * 0.01248d, 2d * 0.01450d, 2d * 0.01677d,
          2d * 0.01932d, 2d * 0.02216d, 2d * 0.02533d, 2d * 0.02884d,
          2d * 0.03270d, 2d * 0.03696d, 2d * 0.04163d, 2d * 0.04672d,
          2d * 0.05229d, 2d * 0.05833d, 2d * 0.06487d, 2d * 0.07193d,
          2d * 0.07953d, 2d * 0.08768d, 2d * 0.09641d },//
      { 2d * 7.629E-06d, 2d * 1.526E-05d, 2d * 2.289E-05d,
          2d * 3.815E-05d, 2d * 5.341E-05d, 2d * 7.629E-05d,
          2d * 0.0001068d, 2d * 0.0001450d, 2d * 0.0001907d,
          2d * 0.0002518d, 2d * 0.0003281d, 2d * 0.0004196d,
          2d * 0.0005341d, 2d * 0.0006714d, 2d * 0.0008392d,
          2d * 0.001045d, 2d * 0.001289d, 2d * 0.001579d, 2d * 0.001923d,
          2d * 0.002319d, 2d * 0.002785d, 2d * 0.003326d, 2d * 0.003952d,
          2d * 0.004669d, 2d * 0.005493d, 2d * 0.006432d, 2d * 0.007500d,
          2d * 0.008713d, 2d * 0.01008d, 2d * 0.01161d, 2d * 0.01334d,
          2d * 0.01526d, 2d * 0.01740d, 2d * 0.01977d, 2d * 0.02238d,
          2d * 0.02527d, 2d * 0.02844d, 2d * 0.03191d, 2d * 0.03571d,
          2d * 0.03984d, 2d * 0.04433d, 2d * 0.04919d, 2d * 0.05444d,
          2d * 0.06010d, 2d * 0.06618d, 2d * 0.07272d, 2d * 0.07969d,
          2d * 0.08713d, 2d * 0.09505d },//
      { 2d * 3.815E-06d, 2d * 7.629E-06d, 2d * 1.144E-05d,
          2d * 1.907E-05d, 2d * 2.670E-05d, 2d * 3.815E-05d,
          2d * 5.341E-05d, 2d * 7.248E-05d, 2d * 9.537E-05d,
          2d * 0.0001259d, 2d * 0.0001640d, 2d * 0.0002098d,
          2d * 0.0002670d, 2d * 0.0003357d, 2d * 0.0004196d,
          2d * 0.0005226d, 2d * 0.0006447d, 2d * 0.0007896d,
          2d * 0.0009651d, 2d * 0.001167d, 2d * 0.001404d, 2d * 0.001682d,
          2d * 0.002003d, 2d * 0.002373d, 2d * 0.002800d, 2d * 0.003288d,
          2d * 0.003845d, 2d * 0.004482d, 2d * 0.005203d, 2d * 0.006016d,
          2d * 0.006935d, 2d * 0.007965d, 2d * 0.009117d, 2d * 0.01041d,
          2d * 0.01184d, 2d * 0.01342d, 2d * 0.01518d, 2d * 0.01712d,
          2d * 0.01925d, 2d * 0.02158d, 2d * 0.02414d, 2d * 0.02693d,
          2d * 0.02997d, 2d * 0.03327d, 2d * 0.03684d, 2d * 0.04071d,
          2d * 0.04488d, 2d * 0.04937d, 2d * 0.05419d, 2d * 0.05935d,
          2d * 0.06487d, 2d * 0.07076d, 2d * 0.07702d, 2d * 0.08368d,
          2d * 0.09073d, 2d * 0.09819d },//
      { 2d * 1.907E-06d, 2d * 3.815E-06d, 2d * 5.722E-06d,
          2d * 9.537E-06d, 2d * 1.335E-05d, 2d * 1.907E-05d,
          2d * 2.670E-05d, 2d * 3.624E-05d, 2d * 4.768E-05d,
          2d * 6.294E-05d, 2d * 8.202E-05d, 2d * 0.0001049d,
          2d * 0.0001335d, 2d * 0.0001678d, 2d * 0.0002098d,
          2d * 0.0002613d, 2d * 0.0003223d, 2d * 0.0003948d,
          2d * 0.0004826d, 2d * 0.0005856d, 2d * 0.0007057d,
          2d * 0.0008469d, 2d * 0.001011d, 2d * 0.001200d, 2d * 0.001419d,
          2d * 0.001671d, 2d * 0.001959d, 2d * 0.002289d, 2d * 0.002665d,
          2d * 0.003090d, 2d * 0.003572d, 2d * 0.004116d, 2d * 0.004726d,
          2d * 0.005413d, 2d * 0.006180d, 2d * 0.007034d, 2d * 0.007986d,
          2d * 0.009041d, 2d * 0.01021d, 2d * 0.01149d, 2d * 0.01291d,
          2d * 0.01447d, 2d * 0.01617d, 2d * 0.01803d, 2d * 0.02007d,
          2d * 0.02228d, 2d * 0.02468d, 2d * 0.02729d, 2d * 0.03010d,
          2d * 0.03314d, 2d * 0.03642d, 2d * 0.03994d, 2d * 0.04371d,
          2d * 0.04776d, 2d * 0.05208d, 2d * 0.05669d, 2d * 0.06159d,
          2d * 0.06681d, 2d * 0.07234d, 2d * 0.07820d, 2d * 0.08440d,
          2d * 0.09093d, 2d * 0.09782d },//
      { 2d * 9.537E-07d, 2d * 1.907E-06d, 2d * 2.861E-06d,
          2d * 4.768E-06d, 2d * 6.676E-06d, 2d * 9.537E-06d,
          2d * 1.335E-05d, 2d * 1.812E-05d, 2d * 2.384E-05d,
          2d * 3.147E-05d, 2d * 4.101E-05d, 2d * 5.245E-05d,
          2d * 6.676E-05d, 2d * 8.392E-05d, 2d * 0.0001049d,
          2d * 0.0001307d, 2d * 0.0001612d, 2d * 0.0001974d,
          2d * 0.0002413d, 2d * 0.0002928d, 2d * 0.0003538d,
          2d * 0.0004253d, 2d * 0.0005083d, 2d * 0.0006046d,
          2d * 0.0007162d, 2d * 0.0008450d, 2d * 0.0009928d,
          2d * 0.001163d, 2d * 0.001356d, 2d * 0.001576d, 2d * 0.001827d,
          2d * 0.002110d, 2d * 0.002430d, 2d * 0.002790d, 2d * 0.003195d,
          2d * 0.003648d, 2d * 0.004154d, 2d * 0.004718d, 2d * 0.005344d,
          2d * 0.006040d, 2d * 0.006808d, 2d * 0.007656d, 2d * 0.008591d,
          2d * 0.009617d, 2d * 0.01074d, 2d * 0.01198d, 2d * 0.01332d,
          2d * 0.01479d, 2d * 0.01638d, 2d * 0.01812d, 2d * 0.01999d,
          2d * 0.02203d, 2d * 0.02422d, 2d * 0.02658d, 2d * 0.02913d,
          2d * 0.03186d, 2d * 0.03479d, 2d * 0.03793d, 2d * 0.04128d,
          2d * 0.04485d, 2d * 0.04865d, 2d * 0.05270d, 2d * 0.05699d,
          2d * 0.06155d, 2d * 0.06636d, 2d * 0.07145d, 2d * 0.07682d,
          2d * 0.08248d, 2d * 0.08843d, 2d * 0.09467d },//
      { 2d * 4.768E-07d, 2d * 9.537E-07d, 2d * 1.431E-06d,
          2d * 2.384E-06d, 2d * 3.338E-06d, 2d * 4.768E-06d,
          2d * 6.676E-06d, 2d * 9.060E-06d, 2d * 1.192E-05d,
          2d * 1.574E-05d, 2d * 2.050E-05d, 2d * 2.623E-05d,
          2d * 3.338E-05d, 2d * 4.196E-05d, 2d * 5.245E-05d,
          2d * 6.533E-05d, 2d * 8.059E-05d, 2d * 9.871E-05d,
          2d * 0.0001206d, 2d * 0.0001464d, 2d * 0.0001769d,
          2d * 0.0002131d, 2d * 0.0002551d, 2d * 0.0003037d,
          2d * 0.0003605d, 2d * 0.0004258d, 2d * 0.0005012d,
          2d * 0.0005879d, 2d * 0.0006871d, 2d * 0.0008001d,
          2d * 0.0009294d, 2d * 0.001076d, 2d * 0.001241d, 2d * 0.001429d,
          2d * 0.001639d, 2d * 0.001876d, 2d * 0.002142d, 2d * 0.002439d,
          2d * 0.002771d, 2d * 0.003140d, 2d * 0.003551d, 2d * 0.004005d,
          2d * 0.004508d, 2d * 0.005063d, 2d * 0.005673d, 2d * 0.006346d,
          2d * 0.007083d, 2d * 0.007890d, 2d * 0.008773d, 2d * 0.009737d,
          2d * 0.01079d, 2d * 0.01193d, 2d * 0.01317d, 2d * 0.01451d,
          2d * 0.01596d, 2d * 0.01753d, 2d * 0.01922d, 2d * 0.02104d,
          2d * 0.02300d, 2d * 0.02510d, 2d * 0.02735d, 2d * 0.02975d,
          2d * 0.03232d, 2d * 0.03507d, 2d * 0.03799d, 2d * 0.04110d,
          2d * 0.04440d, 2d * 0.04790d, 2d * 0.05161d, 2d * 0.05553d,
          2d * 0.05967d, 2d * 0.06404d, 2d * 0.06864d, 2d * 0.07348d,
          2d * 0.07857d, 2d * 0.08390d, 2d * 0.08949d, 2d * 0.09534d },//
      { 2d * 2.384E-07d, 2d * 4.768E-07d, 2d * 7.153E-07d,
          2d * 1.192E-06d, 2d * 1.669E-06d, 2d * 2.384E-06d,
          2d * 3.338E-06d, 2d * 4.530E-06d, 2d * 5.960E-06d,
          2d * 7.868E-06d, 2d * 1.025E-05d, 2d * 1.311E-05d,
          2d * 1.669E-05d, 2d * 2.098E-05d, 2d * 2.623E-05d,
          2d * 3.266E-05d, 2d * 4.029E-05d, 2d * 4.935E-05d,
          2d * 6.032E-05d, 2d * 7.319E-05d, 2d * 8.845E-05d,
          2d * 0.0001066d, 2d * 0.0001278d, 2d * 0.0001523d,
          2d * 0.0001810d, 2d * 0.0002141d, 2d * 0.0002522d,
          2d * 0.0002964d, 2d * 0.0003469d, 2d * 0.0004046d,
          2d * 0.0004706d, 2d * 0.0005457d, 2d * 0.0006309d,
          2d * 0.0007274d, 2d * 0.0008364d, 2d * 0.0009592d,
          2d * 0.001097d, 2d * 0.001252d, 2d * 0.001426d, 2d * 0.001620d,
          2d * 0.001836d, 2d * 0.002076d, 2d * 0.002342d, 2d * 0.002638d,
          2d * 0.002964d, 2d * 0.003325d, 2d * 0.003722d, 2d * 0.004158d,
          2d * 0.004637d, 2d * 0.005162d, 2d * 0.005736d, 2d * 0.006364d,
          2d * 0.007047d, 2d * 0.007792d, 2d * 0.008600d, 2d * 0.009478d,
          2d * 0.01043d, 2d * 0.01146d, 2d * 0.01257d, 2d * 0.01377d,
          2d * 0.01506d, 2d * 0.01645d, 2d * 0.01794d, 2d * 0.01954d,
          2d * 0.02125d, 2d * 0.02308d, 2d * 0.02504d, 2d * 0.02712d,
          2d * 0.02935d, 2d * 0.03171d, 2d * 0.03422d, 2d * 0.03689d,
          2d * 0.03971d, 2d * 0.04270d, 2d * 0.04587d, 2d * 0.04921d,
          2d * 0.05273d, 2d * 0.05644d, 2d * 0.06034d, 2d * 0.06444d,
          2d * 0.06874d, 2d * 0.07326d, 2d * 0.07799d, 2d * 0.08293d,
          2d * 0.08810d, 2d * 0.09349d, 2d * 0.09911d },//
      { 2d * 1.192E-07d, 2d * 2.384E-07d, 2d * 3.576E-07d,
          2d * 5.960E-07d, 2d * 8.345E-07d, 2d * 1.192E-06d,
          2d * 1.669E-06d, 2d * 2.265E-06d, 2d * 2.980E-06d,
          2d * 3.934E-06d, 2d * 5.126E-06d, 2d * 6.557E-06d,
          2d * 8.345E-06d, 2d * 1.049E-05d, 2d * 1.311E-05d,
          2d * 1.633E-05d, 2d * 2.015E-05d, 2d * 2.468E-05d,
          2d * 3.016E-05d, 2d * 3.660E-05d, 2d * 4.423E-05d,
          2d * 5.329E-05d, 2d * 6.390E-05d, 2d * 7.629E-05d,
          2d * 9.072E-05d, 2d * 0.0001074d, 2d * 0.0001267d,
          2d * 0.0001490d, 2d * 0.0001746d, 2d * 0.0002040d,
          2d * 0.0002376d, 2d * 0.0002759d, 2d * 0.0003194d,
          2d * 0.0003688d, 2d * 0.0004247d, 2d * 0.0004879d,
          2d * 0.0005592d, 2d * 0.0006393d, 2d * 0.0007292d,
          2d * 0.0008299d, 2d * 0.0009425d, 2d * 0.001068d,
          2d * 0.001208d, 2d * 0.001363d, 2d * 0.001535d, 2d * 0.001726d,
          2d * 0.001937d, 2d * 0.002169d, 2d * 0.002426d, 2d * 0.002707d,
          2d * 0.003016d, 2d * 0.003355d, 2d * 0.003726d, 2d * 0.004131d,
          2d * 0.004573d, 2d * 0.005055d, 2d * 0.005578d, 2d * 0.006147d,
          2d * 0.006764d, 2d * 0.007433d, 2d * 0.008156d, 2d * 0.008936d,
          2d * 0.009779d, 2d * 0.01069d, 2d * 0.01166d, 2d * 0.01271d,
          2d * 0.01384d, 2d * 0.01504d, 2d * 0.01633d, 2d * 0.01772d,
          2d * 0.01919d, 2d * 0.02076d, 2d * 0.02244d, 2d * 0.02422d,
          2d * 0.02611d, 2d * 0.02813d, 2d * 0.03026d, 2d * 0.03252d,
          2d * 0.03491d, 2d * 0.03743d, 2d * 0.04010d, 2d * 0.04291d,
          2d * 0.04588d, 2d * 0.04899d, 2d * 0.05227d, 2d * 0.05571d,
          2d * 0.05932d, 2d * 0.06311d, 2d * 0.06707d, 2d * 0.07121d,
          2d * 0.07554d, 2d * 0.08005d, 2d * 0.08476d, 2d * 0.08967d,
          2d * 0.09477d },//
      { 2d * 5.960E-08d, 2d * 1.192E-07d, 2d * 1.788E-07d,
          2d * 2.980E-07d, 2d * 4.172E-07d, 2d * 5.960E-07d,
          2d * 8.345E-07d, 2d * 1.132E-06d, 2d * 1.490E-06d,
          2d * 1.967E-06d, 2d * 2.563E-06d, 2d * 3.278E-06d,
          2d * 4.172E-06d, 2d * 5.245E-06d, 2d * 6.557E-06d,
          2d * 8.166E-06d, 2d * 1.007E-05d, 2d * 1.234E-05d,
          2d * 1.508E-05d, 2d * 1.830E-05d, 2d * 2.211E-05d,
          2d * 2.664E-05d, 2d * 3.195E-05d, 2d * 3.815E-05d,
          2d * 4.542E-05d, 2d * 5.382E-05d, 2d * 6.354E-05d,
          2d * 7.480E-05d, 2d * 8.774E-05d, 2d * 0.0001026d,
          2d * 0.0001196d, 2d * 0.0001391d, 2d * 0.0001612d,
          2d * 0.0001864d, 2d * 0.0002149d, 2d * 0.0002472d,
          2d * 0.0002838d, 2d * 0.0003249d, 2d * 0.0003712d,
          2d * 0.0004231d, 2d * 0.0004813d, 2d * 0.0005463d,
          2d * 0.0006190d, 2d * 0.0006999d, 2d * 0.0007898d,
          2d * 0.0008898d, 2d * 0.001000d, 2d * 0.001123d, 2d * 0.001258d,
          2d * 0.001407d, 2d * 0.001572d, 2d * 0.001752d, 2d * 0.001950d,
          2d * 0.002168d, 2d * 0.002405d, 2d * 0.002665d, 2d * 0.002949d,
          2d * 0.003258d, 2d * 0.003595d, 2d * 0.003960d, 2d * 0.004357d,
          2d * 0.004788d, 2d * 0.005254d, 2d * 0.005758d, 2d * 0.006302d,
          2d * 0.006890d, 2d * 0.007522d, 2d * 0.008203d, 2d * 0.008935d,
          2d * 0.009721d, 2d * 0.01056d, 2d * 0.01147d, 2d * 0.01243d,
          2d * 0.01346d, 2d * 0.01457d, 2d * 0.01574d, 2d * 0.01699d,
          2d * 0.01832d, 2d * 0.01974d, 2d * 0.02124d, 2d * 0.02284d,
          2d * 0.02453d, 2d * 0.02632d, 2d * 0.02821d, 2d * 0.03021d,
          2d * 0.03232d, 2d * 0.03455d, 2d * 0.03690d, 2d * 0.03936d,
          2d * 0.04196d, 2d * 0.04469d, 2d * 0.04755d, 2d * 0.05055d,
          2d * 0.05369d, 2d * 0.05698d, 2d * 0.06042d, 2d * 0.06401d,
          2d * 0.06776d, 2d * 0.07168d, 2d * 0.07575d, 2d * 0.07999d,
          2d * 0.08440d, 2d * 0.08899d, 2d * 0.09375d, 2d * 0.09869d },//
      { 2d * 2.980E-08d, 2d * 5.960E-08d, 2d * 8.941E-08d,
          2d * 1.490E-07d, 2d * 2.086E-07d, 2d * 2.980E-07d,
          2d * 4.172E-07d, 2d * 5.662E-07d, 2d * 7.451E-07d,
          2d * 9.835E-07d, 2d * 1.281E-06d, 2d * 1.639E-06d,
          2d * 2.086E-06d, 2d * 2.623E-06d, 2d * 3.278E-06d,
          2d * 4.083E-06d, 2d * 5.037E-06d, 2d * 6.169E-06d,
          2d * 7.540E-06d, 2d * 9.149E-06d, 2d * 1.106E-05d,
          2d * 1.332E-05d, 2d * 1.597E-05d, 2d * 1.907E-05d,
          2d * 2.271E-05d, 2d * 2.694E-05d, 2d * 3.183E-05d,
          2d * 3.749E-05d, 2d * 4.402E-05d, 2d * 5.150E-05d,
          2d * 6.011E-05d, 2d * 6.995E-05d, 2d * 8.115E-05d,
          2d * 9.394E-05d, 2d * 0.0001085d, 2d * 0.0001249d,
          2d * 0.0001435d, 2d * 0.0001645d, 2d * 0.0001882d,
          2d * 0.0002148d, 2d * 0.0002447d, 2d * 0.0002782d,
          2d * 0.0003157d, 2d * 0.0003575d, 2d * 0.0004041d,
          2d * 0.0004559d, 2d * 0.0005136d, 2d * 0.0005774d,
          2d * 0.0006482d, 2d * 0.0007264d, 2d * 0.0008127d,
          2d * 0.0009078d, 2d * 0.001013d, 2d * 0.001128d, 2d * 0.001254d,
          2d * 0.001392d, 2d * 0.001544d, 2d * 0.001710d, 2d * 0.001890d,
          2d * 0.002088d, 2d * 0.002302d, 2d * 0.002536d, 2d * 0.002789d,
          2d * 0.003065d, 2d * 0.003363d, 2d * 0.003685d, 2d * 0.004034d,
          2d * 0.004411d, 2d * 0.004818d, 2d * 0.005255d, 2d * 0.005727d,
          2d * 0.006233d, 2d * 0.006777d, 2d * 0.007361d, 2d * 0.007986d,
          2d * 0.008656d, 2d * 0.009372d, 2d * 0.01014d, 2d * 0.01095d,
          2d * 0.01182d, 2d * 0.01275d, 2d * 0.01374d, 2d * 0.01479d,
          2d * 0.01590d, 2d * 0.01709d, 2d * 0.01834d, 2d * 0.01967d,
          2d * 0.02108d, 2d * 0.02256d, 2d * 0.02413d, 2d * 0.02579d,
          2d * 0.02754d, 2d * 0.02938d, 2d * 0.03131d, 2d * 0.03335d,
          2d * 0.03549d, 2d * 0.03774d, 2d * 0.04010d, 2d * 0.04257d,
          2d * 0.04516d, 2d * 0.04787d, 2d * 0.05070d, 2d * 0.05366d,
          2d * 0.05675d, 2d * 0.05997d, 2d * 0.06332d, 2d * 0.06682d,
          2d * 0.07046d, 2d * 0.07424d, 2d * 0.07817d, 2d * 0.08225d,
          2d * 0.08648d, 2d * 0.09086d, 2d * 0.09541d },//
      { 2d * 1.490E-08d, 2d * 2.980E-08d, 2d * 4.470E-08d,
          2d * 7.451E-08d, 2d * 1.043E-07d, 2d * 1.490E-07d,
          2d * 2.086E-07d, 2d * 2.831E-07d, 2d * 3.725E-07d,
          2d * 4.917E-07d, 2d * 6.407E-07d, 2d * 8.196E-07d,
          2d * 1.043E-06d, 2d * 1.311E-06d, 2d * 1.639E-06d,
          2d * 2.041E-06d, 2d * 2.518E-06d, 2d * 3.085E-06d,
          2d * 3.770E-06d, 2d * 4.575E-06d, 2d * 5.528E-06d,
          2d * 6.661E-06d, 2d * 7.987E-06d, 2d * 9.537E-06d,
          2d * 1.135E-05d, 2d * 1.347E-05d, 2d * 1.593E-05d,
          2d * 1.878E-05d, 2d * 2.205E-05d, 2d * 2.582E-05d,
          2d * 3.016E-05d, 2d * 3.512E-05d, 2d * 4.078E-05d,
          2d * 4.725E-05d, 2d * 5.460E-05d, 2d * 6.294E-05d,
          2d * 7.240E-05d, 2d * 8.309E-05d, 2d * 9.514E-05d,
          2d * 0.0001087d, 2d * 0.0001240d, 2d * 0.0001411d,
          2d * 0.0001604d, 2d * 0.0001818d, 2d * 0.0002058d,
          2d * 0.0002325d, 2d * 0.0002623d, 2d * 0.0002954d,
          2d * 0.0003321d, 2d * 0.0003727d, 2d * 0.0004177d,
          2d * 0.0004674d, 2d * 0.0005222d, 2d * 0.0005826d,
          2d * 0.0006490d, 2d * 0.0007220d, 2d * 0.0008020d,
          2d * 0.0008898d, 2d * 0.0009858d, 2d * 0.001091d,
          2d * 0.001205d, 2d * 0.001330d, 2d * 0.001466d, 2d * 0.001615d,
          2d * 0.001775d, 2d * 0.001950d, 2d * 0.002140d, 2d * 0.002345d,
          2d * 0.002567d, 2d * 0.002806d, 2d * 0.003065d, 2d * 0.003345d,
          2d * 0.003645d, 2d * 0.003969d, 2d * 0.004317d, 2d * 0.004691d,
          2d * 0.005093d, 2d * 0.005523d, 2d * 0.005983d, 2d * 0.006476d,
          2d * 0.007003d, 2d * 0.007566d, 2d * 0.008167d, 2d * 0.008807d,
          2d * 0.009489d, 2d * 0.01021d, 2d * 0.01099d, 2d * 0.01181d,
          2d * 0.01268d, 2d * 0.01360d, 2d * 0.01458d, 2d * 0.01561d,
          2d * 0.01671d, 2d * 0.01786d, 2d * 0.01908d, 2d * 0.02037d,
          2d * 0.02173d, 2d * 0.02317d, 2d * 0.02467d, 2d * 0.02626d,
          2d * 0.02793d, 2d * 0.02968d, 2d * 0.03151d, 2d * 0.03344d,
          2d * 0.03546d, 2d * 0.03757d, 2d * 0.03979d, 2d * 0.04210d,
          2d * 0.04451d, 2d * 0.04704d, 2d * 0.04967d, 2d * 0.05241d,
          2d * 0.05527d, 2d * 0.05824d, 2d * 0.06133d, 2d * 0.06455d,
          2d * 0.06789d, 2d * 0.07136d, 2d * 0.07495d, 2d * 0.07868d,
          2d * 0.08254d, 2d * 0.08654d, 2d * 0.09068d, 2d * 0.09495d,
          2d * 0.09937d },//
      { 2d * 7.451E-09d, 2d * 1.490E-08d, 2d * 2.235E-08d,
          2d * 3.725E-08d, 2d * 5.215E-08d, 2d * 7.451E-08d,
          2d * 1.043E-07d, 2d * 1.416E-07d, 2d * 1.863E-07d,
          2d * 2.459E-07d, 2d * 3.204E-07d, 2d * 4.098E-07d,
          2d * 5.215E-07d, 2d * 6.557E-07d, 2d * 8.196E-07d,
          2d * 1.021E-06d, 2d * 1.259E-06d, 2d * 1.542E-06d,
          2d * 1.885E-06d, 2d * 2.287E-06d, 2d * 2.764E-06d,
          2d * 3.330E-06d, 2d * 3.994E-06d, 2d * 4.768E-06d,
          2d * 5.677E-06d, 2d * 6.735E-06d, 2d * 7.965E-06d,
          2d * 9.395E-06d, 2d * 1.104E-05d, 2d * 1.293E-05d,
          2d * 1.512E-05d, 2d * 1.761E-05d, 2d * 2.047E-05d,
          2d * 2.373E-05d, 2d * 2.744E-05d, 2d * 3.166E-05d,
          2d * 3.645E-05d, 2d * 4.186E-05d, 2d * 4.798E-05d,
          2d * 5.489E-05d, 2d * 6.266E-05d, 2d * 7.139E-05d,
          2d * 8.120E-05d, 2d * 9.217E-05d, 2d * 0.0001044d,
          2d * 0.0001182d, 2d * 0.0001334d, 2d * 0.0001504d,
          2d * 0.0001694d, 2d * 0.0001904d, 2d * 0.0002136d,
          2d * 0.0002394d, 2d * 0.0002678d, 2d * 0.0002992d,
          2d * 0.0003339d, 2d * 0.0003720d, 2d * 0.0004139d,
          2d * 0.0004600d, 2d * 0.0005105d, 2d * 0.0005658d,
          2d * 0.0006263d, 2d * 0.0006925d, 2d * 0.0007647d,
          2d * 0.0008435d, 2d * 0.0009293d, 2d * 0.001023d,
          2d * 0.001124d, 2d * 0.001234d, 2d * 0.001354d, 2d * 0.001483d,
          2d * 0.001624d, 2d * 0.001775d, 2d * 0.001939d, 2d * 0.002116d,
          2d * 0.002306d, 2d * 0.002512d, 2d * 0.002733d, 2d * 0.002970d,
          2d * 0.003225d, 2d * 0.003499d, 2d * 0.003793d, 2d * 0.004108d,
          2d * 0.004444d, 2d * 0.004804d, 2d * 0.005189d, 2d * 0.005600d,
          2d * 0.006038d, 2d * 0.006505d, 2d * 0.007003d, 2d * 0.007532d,
          2d * 0.008095d, 2d * 0.008693d, 2d * 0.009328d, 2d * 0.01000d,
          2d * 0.01071d, 2d * 0.01147d, 2d * 0.01227d, 2d * 0.01312d,
          2d * 0.01401d, 2d * 0.01495d, 2d * 0.01595d, 2d * 0.01700d,
          2d * 0.01810d, 2d * 0.01927d, 2d * 0.02049d, 2d * 0.02178d,
          2d * 0.02313d, 2d * 0.02455d, 2d * 0.02604d, 2d * 0.02760d,
          2d * 0.02924d, 2d * 0.03095d, 2d * 0.03274d, 2d * 0.03461d,
          2d * 0.03657d, 2d * 0.03861d, 2d * 0.04074d, 2d * 0.04297d,
          2d * 0.04528d, 2d * 0.04769d, 2d * 0.05020d, 2d * 0.05281d,
          2d * 0.05553d, 2d * 0.05834d, 2d * 0.06127d, 2d * 0.06430d,
          2d * 0.06744d, 2d * 0.07070d, 2d * 0.07408d, 2d * 0.07757d,
          2d * 0.08118d, 2d * 0.08491d, 2d * 0.08876d, 2d * 0.09274d,
          2d * 0.09684d },//
      { 2d * 3.725E-09d, 2d * 7.451E-09d, 2d * 1.118E-08d,
          2d * 1.863E-08d, 2d * 2.608E-08d, 2d * 3.725E-08d,
          2d * 5.215E-08d, 2d * 7.078E-08d, 2d * 9.313E-08d,
          2d * 1.229E-07d, 2d * 1.602E-07d, 2d * 2.049E-07d,
          2d * 2.608E-07d, 2d * 3.278E-07d, 2d * 4.098E-07d,
          2d * 5.104E-07d, 2d * 6.296E-07d, 2d * 7.711E-07d,
          2d * 9.425E-07d, 2d * 1.144E-06d, 2d * 1.382E-06d,
          2d * 1.665E-06d, 2d * 1.997E-06d, 2d * 2.384E-06d,
          2d * 2.839E-06d, 2d * 3.368E-06d, 2d * 3.982E-06d,
          2d * 4.698E-06d, 2d * 5.525E-06d, 2d * 6.475E-06d,
          2d * 7.570E-06d, 2d * 8.825E-06d, 2d * 1.026E-05d,
          2d * 1.190E-05d, 2d * 1.377E-05d, 2d * 1.590E-05d,
          2d * 1.832E-05d, 2d * 2.106E-05d, 2d * 2.415E-05d,
          2d * 2.765E-05d, 2d * 3.159E-05d, 2d * 3.602E-05d,
          2d * 4.101E-05d, 2d * 4.660E-05d, 2d * 5.285E-05d,
          2d * 5.985E-05d, 2d * 6.766E-05d, 2d * 7.637E-05d,
          2d * 8.607E-05d, 2d * 9.684E-05d, 2d * 0.0001088d,
          2d * 0.0001221d, 2d * 0.0001368d, 2d * 0.0001530d,
          2d * 0.0001709d, 2d * 0.0001907d, 2d * 0.0002125d,
          2d * 0.0002365d, 2d * 0.0002628d, 2d * 0.0002917d,
          2d * 0.0003234d, 2d * 0.0003581d, 2d * 0.0003961d,
          2d * 0.0004376d, 2d * 0.0004829d, 2d * 0.0005323d,
          2d * 0.0005861d, 2d * 0.0006446d, 2d * 0.0007083d,
          2d * 0.0007774d, 2d * 0.0008524d, 2d * 0.0009337d,
          2d * 0.001022d, 2d * 0.001117d, 2d * 0.001220d, 2d * 0.001331d,
          2d * 0.001451d, 2d * 0.001580d, 2d * 0.001719d, 2d * 0.001869d,
          2d * 0.002030d, 2d * 0.002203d, 2d * 0.002389d, 2d * 0.002588d,
          2d * 0.002802d, 2d * 0.003030d, 2d * 0.003274d, 2d * 0.003536d,
          2d * 0.003815d, 2d * 0.004112d, 2d * 0.004430d, 2d * 0.004768d,
          2d * 0.005128d, 2d * 0.005512d, 2d * 0.005919d, 2d * 0.006352d,
          2d * 0.006812d, 2d * 0.007299d, 2d * 0.007816d, 2d * 0.008364d,
          2d * 0.008943d, 2d * 0.009557d, 2d * 0.01020d, 2d * 0.01089d,
          2d * 0.01161d, 2d * 0.01237d, 2d * 0.01318d, 2d * 0.01403d,
          2d * 0.01492d, 2d * 0.01585d, 2d * 0.01684d, 2d * 0.01788d,
          2d * 0.01896d, 2d * 0.02011d, 2d * 0.02130d, 2d * 0.02256d,
          2d * 0.02387d, 2d * 0.02525d, 2d * 0.02669d, 2d * 0.02819d,
          2d * 0.02977d, 2d * 0.03141d, 2d * 0.03312d, 2d * 0.03491d,
          2d * 0.03677d, 2d * 0.03871d, 2d * 0.04073d, 2d * 0.04283d,
          2d * 0.04501d, 2d * 0.04728d, 2d * 0.04964d, 2d * 0.05209d,
          2d * 0.05463d, 2d * 0.05726d, 2d * 0.05999d, 2d * 0.06281d,
          2d * 0.06573d, 2d * 0.06876d, 2d * 0.07189d, 2d * 0.07512d,
          2d * 0.07845d, 2d * 0.08190d, 2d * 0.08545d, 2d * 0.08912d,
          2d * 0.09289d, 2d * 0.09678d },//
      { 2d * 1.863E-09d, 2d * 3.725E-09d, 2d * 5.588E-09d,
          2d * 9.313E-09d, 2d * 1.304E-08d, 2d * 1.863E-08d,
          2d * 2.608E-08d, 2d * 3.539E-08d, 2d * 4.657E-08d,
          2d * 6.147E-08d, 2d * 8.009E-08d, 2d * 1.024E-07d,
          2d * 1.304E-07d, 2d * 1.639E-07d, 2d * 2.049E-07d,
          2d * 2.552E-07d, 2d * 3.148E-07d, 2d * 3.856E-07d,
          2d * 4.712E-07d, 2d * 5.718E-07d, 2d * 6.910E-07d,
          2d * 8.326E-07d, 2d * 9.984E-07d, 2d * 1.192E-06d,
          2d * 1.419E-06d, 2d * 1.684E-06d, 2d * 1.991E-06d,
          2d * 2.349E-06d, 2d * 2.762E-06d, 2d * 3.239E-06d,
          2d * 3.789E-06d, 2d * 4.418E-06d, 2d * 5.139E-06d,
          2d * 5.964E-06d, 2d * 6.905E-06d, 2d * 7.976E-06d,
          2d * 9.194E-06d, 2d * 1.057E-05d, 2d * 1.214E-05d,
          2d * 1.390E-05d, 2d * 1.590E-05d, 2d * 1.814E-05d,
          2d * 2.067E-05d, 2d * 2.350E-05d, 2d * 2.668E-05d,
          2d * 3.024E-05d, 2d * 3.422E-05d, 2d * 3.866E-05d,
          2d * 4.360E-05d, 2d * 4.911E-05d, 2d * 5.523E-05d,
          2d * 6.203E-05d, 2d * 6.957E-05d, 2d * 7.791E-05d,
          2d * 8.715E-05d, 2d * 9.734E-05d, 2d * 0.0001086d,
          2d * 0.0001210d, 2d * 0.0001346d, 2d * 0.0001496d,
          2d * 0.0001661d, 2d * 0.0001842d, 2d * 0.0002040d,
          2d * 0.0002257d, 2d * 0.0002494d, 2d * 0.0002753d,
          2d * 0.0003036d, 2d * 0.0003344d, 2d * 0.0003680d,
          2d * 0.0004045d, 2d * 0.0004442d, 2d * 0.0004873d,
          2d * 0.0005342d, 2d * 0.0005849d, 2d * 0.0006399d,
          2d * 0.0006994d, 2d * 0.0007637d, 2d * 0.0008332d,
          2d * 0.0009082d, 2d * 0.0009891d, 2d * 0.001076d,
          2d * 0.001170d, 2d * 0.001271d, 2d * 0.001380d, 2d * 0.001496d,
          2d * 0.001621d, 2d * 0.001755d, 2d * 0.001899d, 2d * 0.002053d,
          2d * 0.002218d, 2d * 0.002394d, 2d * 0.002582d, 2d * 0.002783d,
          2d * 0.002997d, 2d * 0.003226d, 2d * 0.003469d, 2d * 0.003728d,
          2d * 0.004004d, 2d * 0.004297d, 2d * 0.004608d, 2d * 0.004939d,
          2d * 0.005289d, 2d * 0.005661d, 2d * 0.006055d, 2d * 0.006472d,
          2d * 0.006913d, 2d * 0.007379d, 2d * 0.007872d, 2d * 0.008393d,
          2d * 0.008942d, 2d * 0.009522d, 2d * 0.01013d, 2d * 0.01078d,
          2d * 0.01145d, 2d * 0.01217d, 2d * 0.01292d, 2d * 0.01370d,
          2d * 0.01453d, 2d * 0.01540d, 2d * 0.01631d, 2d * 0.01727d,
          2d * 0.01827d, 2d * 0.01932d, 2d * 0.02041d, 2d * 0.02156d,
          2d * 0.02276d, 2d * 0.02401d, 2d * 0.02532d, 2d * 0.02669d,
          2d * 0.02811d, 2d * 0.02960d, 2d * 0.03115d, 2d * 0.03276d,
          2d * 0.03444d, 2d * 0.03618d, 2d * 0.03799d, 2d * 0.03988d,
          2d * 0.04184d, 2d * 0.04387d, 2d * 0.04598d, 2d * 0.04817d,
          2d * 0.05043d, 2d * 0.05278d, 2d * 0.05521d, 2d * 0.05773d,
          2d * 0.06033d, 2d * 0.06302d, 2d * 0.06580d, 2d * 0.06866d,
          2d * 0.07163d, 2d * 0.07468d, 2d * 0.07783d, 2d * 0.08108d,
          2d * 0.08443d, 2d * 0.08787d, 2d * 0.09142d, 2d * 0.09506d,
          2d * 0.09881d },//
      { 2d * 9.313E-10d, 2d * 1.863E-09d, 2d * 2.794E-09d,
          2d * 4.657E-09d, 2d * 6.519E-09d, 2d * 9.313E-09d,
          2d * 1.304E-08d, 2d * 1.770E-08d, 2d * 2.328E-08d,
          2d * 3.073E-08d, 2d * 4.005E-08d, 2d * 5.122E-08d,
          2d * 6.519E-08d, 2d * 8.196E-08d, 2d * 1.024E-07d,
          2d * 1.276E-07d, 2d * 1.574E-07d, 2d * 1.928E-07d,
          2d * 2.356E-07d, 2d * 2.859E-07d, 2d * 3.455E-07d,
          2d * 4.163E-07d, 2d * 4.992E-07d, 2d * 5.960E-07d,
          2d * 7.097E-07d, 2d * 8.419E-07d, 2d * 9.956E-07d,
          2d * 1.174E-06d, 2d * 1.381E-06d, 2d * 1.620E-06d,
          2d * 1.895E-06d, 2d * 2.211E-06d, 2d * 2.572E-06d,
          2d * 2.987E-06d, 2d * 3.459E-06d, 2d * 3.997E-06d,
          2d * 4.610E-06d, 2d * 5.305E-06d, 2d * 6.092E-06d,
          2d * 6.983E-06d, 2d * 7.989E-06d, 2d * 9.122E-06d,
          2d * 1.040E-05d, 2d * 1.183E-05d, 2d * 1.344E-05d,
          2d * 1.525E-05d, 2d * 1.727E-05d, 2d * 1.952E-05d,
          2d * 2.204E-05d, 2d * 2.484E-05d, 2d * 2.796E-05d,
          2d * 3.143E-05d, 2d * 3.528E-05d, 2d * 3.955E-05d,
          2d * 4.428E-05d, 2d * 4.951E-05d, 2d * 5.529E-05d,
          2d * 6.167E-05d, 2d * 6.870E-05d, 2d * 7.644E-05d,
          2d * 8.495E-05d, 2d * 9.430E-05d, 2d * 0.0001046d,
          2d * 0.0001158d, 2d * 0.0001281d, 2d * 0.0001416d,
          2d * 0.0001564d, 2d * 0.0001725d, 2d * 0.0001900d,
          2d * 0.0002092d, 2d * 0.0002301d, 2d * 0.0002527d,
          2d * 0.0002774d, 2d * 0.0003042d, 2d * 0.0003333d,
          2d * 0.0003648d, 2d * 0.0003989d, 2d * 0.0004359d,
          2d * 0.0004759d, 2d * 0.0005191d, 2d * 0.0005657d,
          2d * 0.0006161d, 2d * 0.0006703d, 2d * 0.0007287d,
          2d * 0.0007916d, 2d * 0.0008593d, 2d * 0.0009320d,
          2d * 0.001010d, 2d * 0.001094d, 2d * 0.001184d, 2d * 0.001280d,
          2d * 0.001383d, 2d * 0.001494d, 2d * 0.001611d, 2d * 0.001738d,
          2d * 0.001872d, 2d * 0.002016d, 2d * 0.002169d, 2d * 0.002332d,
          2d * 0.002506d, 2d * 0.002691d, 2d * 0.002888d, 2d * 0.003097d,
          2d * 0.003320d, 2d * 0.003556d, 2d * 0.003806d, 2d * 0.004071d,
          2d * 0.004353d, 2d * 0.004651d, 2d * 0.004966d, 2d * 0.005299d,
          2d * 0.005652d, 2d * 0.006024d, 2d * 0.006417d, 2d * 0.006832d,
          2d * 0.007269d, 2d * 0.007730d, 2d * 0.008216d, 2d * 0.008727d,
          2d * 0.009265d, 2d * 0.009830d, 2d * 0.01042d, 2d * 0.01105d,
          2d * 0.01171d, 2d * 0.01239d, 2d * 0.01311d, 2d * 0.01387d,
          2d * 0.01466d, 2d * 0.01549d, 2d * 0.01636d, 2d * 0.01727d,
          2d * 0.01822d, 2d * 0.01921d, 2d * 0.02024d, 2d * 0.02133d,
          2d * 0.02245d, 2d * 0.02363d, 2d * 0.02486d, 2d * 0.02613d,
          2d * 0.02746d, 2d * 0.02884d, 2d * 0.03028d, 2d * 0.03178d,
          2d * 0.03333d, 2d * 0.03495d, 2d * 0.03662d, 2d * 0.03836d,
          2d * 0.04016d, 2d * 0.04203d, 2d * 0.04397d, 2d * 0.04597d,
          2d * 0.04805d, 2d * 0.05020d, 2d * 0.05242d, 2d * 0.05472d,
          2d * 0.05709d, 2d * 0.05954d, 2d * 0.06207d, 2d * 0.06468d,
          2d * 0.06737d, 2d * 0.07014d, 2d * 0.07300d, 2d * 0.07594d,
          2d * 0.07897d, 2d * 0.08209d, 2d * 0.08530d, 2d * 0.08860d,
          2d * 0.09198d, 2d * 0.09546d, 2d * 0.09904 } //

  };

  /**
   * Compute the sign test
   * 
   * @param differences
   *          the differences
   * @return the p value
   */
  public static final double signTest(final double[] differences) {
    int i, ap, am, n;
    double d, zpf;

    am = 0;
    ap = 0;
    for (i = (differences.length - 1); i >= 0; i--) {
      d = differences[i];
      if (d != 0d) {
        if (d < 0)
          am++;
        else
          ap++;
      }
    }

    n = (ap + am);
    if (ap < am)
      am = ap;
    d = 0d;
    zpf = Math.pow(0.5d, n);
    for (i = 0; i <= am; i++) {
      d += (zpf * Mathematics.binomial(n, i));
    }

    return (2d * d);
  }

  /**
   * Compute the sum of the signed ranks
   * 
   * @param differences
   *          the differences
   * @return the p value
   */
  public static final double signedRankSum(final double[] differences) {
    double[] d;
    int i, j, c;
    double r, r2, rs;

    c = differences.length;
    if (c <= 0)
      return -1;
    d = differences.clone();

    for (i = (c - 1); i > 0; i--) {
      r = Math.abs(d[i]);
      for (j = (i - 1); j >= 0; j--) {
        r2 = d[j];
        if (Math.abs(r2) > r) {
          d[j] = d[i];
          d[i] = r2;
          r = Math.abs(r2);
        }
      }
    }

    rs = 0d;
    for (i = 0; i < c;) {
      for (j = i + 1; j < c; j++) {
        if (Math.abs(d[i]) != Math.abs(d[j])) {
          break;
        }
      }

      r = (0.5 * (j + i)) + 0.5d;
      for (; i < j; i++) {
        if (d[i] > 0) {
          rs += r;
        } else {
          rs -= r;
        }
      }
    }

    return rs;
  }

  /**
   * Compute the signed rank test
   * 
   * @param differences
   *          the differences
   * @return the p value, or <code>-1</code> if it could not be computed
   */
  public static final double signedRankTest(final double[] differences) {
    double[] d, x;
    int i, j, c, cnt;
    double r, r2, rsm, rsp;

    c = differences.length;
    if (c <= 0)
      return -1;
    d = differences.clone();

    // compute the ranks

    for (i = (c - 1); i > 0; i--) {
      r = Math.abs(d[i]);
      for (j = (i - 1); j >= 0; j--) {
        r2 = d[j];
        if (Math.abs(r2) > r) {
          d[j] = d[i];
          d[i] = r2;
          r = Math.abs(r2);
        }
      }
    }

    x = new double[c];
    rsm = rsp = 0d;
    for (i = 0; i < c;) {
      for (j = i + 1; j < c; j++) {
        if (Math.abs(d[i]) != Math.abs(d[j])) {
          break;
        }
      }

      r = (0.5 * (j + i)) + 0.5d;
      for (; i < j; i++) {
        if (d[i] > 0) {
          rsp += r;
        } else {
          rsm += r;
        }
        x[i] = r;
      }
    }

    if (rsp < rsm)
      rsm = rsp;

    // compute the number of as-least-as-extreme rankings
    if (c <= 24) {
      cnt = 0;
      for (i = ((1 << c) - 1); i >= 0; i--) {
        r = 0d;
        for (j = (c - 1); j >= 0; j--) {
          if ((i & (1 << j)) != 0)
            r += x[j];
        }
        if (r <= rsm)
          cnt++;
      }

      return (((double) (cnt << 1)) / (1 << c));
    }

    rsp = wilcoxPrecise(c, rsm);
    if (rsp >= 0d)
      return rsp;

    return wilcoxPrecise2(c, rsm);
  }

  /**
   * the precise wilcoxon test
   * 
   * @param n
   *          the n
   * @param sum
   *          the rank sum
   * @return the precise value, or <code>-1</code> if none found
   */
  private static final double wilcoxPrecise(final int n, final double sum) {
    double[] p;
    int i;

    if ((sum < 0d) || (n < 0d))
      return -1;
    if (n >= PREC_WILCOXON.length)
      return -1;

    p = PREC_WILCOXON[n];
    i = (int) (0.5d + sum);
    if (i >= p.length)
      return -1;
    return p[i];
  }

  /**
   * the precise wilcoxon test
   * 
   * @param n
   *          the n
   * @param sum
   *          the rank sum
   * @return the almost precise value, or <code>-1</code> if none found
   */
  private static final double wilcoxPrecise2(final int n, final double sum) {
    int i;
    double[] p;

    if ((sum < 0d) || (n < 0d))
      return -1;
    if (n >= SIGNED_RANK.length)
      return -1;

    p = SIGNED_RANK[n];
    for (i = (p.length - 1); i >= 0; i--) {
      if (p[i] >= sum)
        break;
    }

    if (i >= 0)
      return SIGNED_RANK_PROB[i];
    return 2;
  }

  /**
   * Compute the randomization test
   * 
   * @param differences
   *          the differences
   * @return the p value or <code>-1</code> if it could not be computed
   */
  public static final double randomizationTest(final double[] differences) {
    int i, j, c, leq, geq;
    double sum, os;

    c = differences.length;
    if ((c <= 0) || (c > 24))
      return -1;

    os = 0d;
    for (i = (c - 1); i >= 0; i--) {
      os += differences[i];
    }
    if(Double.isNaN(os)) return -1;
    os = Math.abs(os);

    leq = geq = 0;
    for (i = ((1 << c) - 1); i >= 0; i--) {
      sum = 0d;
      for (j = (c - 1); j >= 0; j--) {
        if ((i & (1 << j)) != 0)
          sum += differences[j];
        else
          sum -= differences[j];
      }

      if(Double.isNaN(sum)) return -1;
      sum = Math.abs(sum);
      if (sum >= os)
        geq++;
      if (sum <= os)
        leq++;
    }

    return ((double) (Math.min(leq, geq))) / (1 << c);
  }

}
